{% extends "Layout.html" %}
{% block content %}
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<meta charset="utf-8">
	<title>Purchase Tickets</title>
	<style type="text/css">
		h1 { font-family: monospace; }
		h2 { font-family: monospace; font-size: 20px; }
		div { text-align: center; }
		#first-panel {
			border: 4px solid white;
			background-color: white;
			height: 800px;
			width: 1200px;
			margin: auto;
			padding: 20px;
		}
	</style>
</head>

<html>
<body>
	<p></p>
	<div id="first-panel">
		<h1>Movie Details</h2>
		<div id="showcards">
			<div class="well showcard"></div>
		</div>
		
		<div>
			<h1>Ticket Quantity</h2>
			<select name="QtyDropDown">
				<option>1 Seat</option>
				<option>2 Seats</option>
				<option>3 Seats</option>
				<option>4 Seats</option>
				<option>5 Seats</option>
			</select>
		</div>
	
		<p></p>	
		<h1>Food Bundling Options</h1>
			<h2>Popcorn  <input type="text" size="10" placeholder="quantity" id="PopcornQty"></h2>
			<h2>Pretzels <input type="text" size="10" placeholder="quantity" id="PretzelsQty"></h2>
			<h2>Corndogs <input type="text" size="10" placeholder="quantity" id="CorndogsQty"></h2>
			<h2>Poutine  <input type="text" size="10" placeholder="quantity" id="PoutineQty"></h2>
			<h2>Nachos   <input type="text" size="10" placeholder="quantity" id="NachosQty"></h2>
			
		<div>
			<button id="btnSubmit">Submit</button></div>
		</div>
	</div>
	
	<script>
		$(document).ready(function() {	
			$.ajax({
				url: "/BuyTickets/populate-movies",
				type: "GET",

				success: function (data) {
					console.log(data);
					var selector = $("#select-movie");
					populateHelper(JSON.parse(data), selector, "Title");
					populateMovies(JSON.parse(data));
				},
				error: function() {
					alert("Something failed");
				}
			});
		
			function populateMovies(data) {
				var selector = $("#showcards");
				selector.empty();
				for (var i = 0; i < data.length; i++) {
					selector.append("<div class='well showcards'>" + JSON.stringify(data[i]) + "</div>");
				}      
			}

			function populateHelper(data, selector, key) {
				var temp = [];
				selector.empty();
				selector.append('<option></option>'); //blank option to "deselect"
				for (var i = 0; i < data.length; i++) {
					if (!temp.includes(data[i][key])) {
						selector.append('<option>' + data[i][key] + '</option>');
						temp.push(data[i][key]);
					}
				}
			}    
		});
		
		$("#btnSubmit").click(function() {
			alert("You have successfully purchased a ticket");
		
			$.ajax({
				url: "/BuyTickets",
				type: "GET",
				success: function () {
					window.location.replace("/account");
				}
			});
		});
	</script>
</body>
</html>
{% endblock %}